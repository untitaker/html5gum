{
  "tests": [
    {
      "description": "span tracking with naively_switch_states=false",
      "input": "<!DOCTYPE html>\n<h1>Hello</h1>\n<p attr=\"value\"></p>\n<p>content</p>\n<!-- A comment -->\n<h2>Subtitle</h2>\n<br/>\n<script>console.log('hello')</script>\n<script>nested('<div></div>')</script>\n<style>.class { color: red; }</style>\n<textarea>user input</textarea>\n",
      "naively_switch_states": false,
      "expected_tokens": [
        ["DOCTYPE","html",null,null,true,0,15],
        ["Character","\n",15,16],
        ["StartTag","h1",{},false,16,20],
        ["Character","Hello",20,25],
        ["EndTag","h1",25,30],
        ["Character","\n",30,31],
        ["StartTag","p",{"attr":["value",34,46]},false,31,47],
        ["EndTag","p",47,51],
        ["Character","\n",51,52],
        ["StartTag","p",{},false,52,55],
        ["Character","content",55,62],
        ["EndTag","p",62,66],
        ["Character","\n",66,67],
        ["Comment"," A comment ",67,85],
        ["Character","\n",85,86],
        ["StartTag","h2",{},false,86,90],
        ["Character","Subtitle",90,98],
        ["EndTag","h2",98,103],
        ["Character","\n",103,104],
        ["StartTag","br",{},true,104,109],
        ["Character","\n",109,110],
        ["StartTag","script",{},false,110,118],
        ["Character","console.log('hello')",118,138],
        ["EndTag","script",138,147],
        ["Character","\n",147,148],
        ["StartTag","script",{},false,148,156],
        ["Character","nested('",156,164],
        ["StartTag","div",{},false,164,169],
        ["EndTag","div",169,175],
        ["Character","')",175,177],
        ["EndTag","script",177,186],
        ["Character","\n",186,187],
        ["StartTag","style",{},false,187,194],
        ["Character",".class { color: red; }",194,216],
        ["EndTag","style",216,224],
        ["Character","\n",224,225],
        ["StartTag","textarea",{},false,225,235],
        ["Character","user input",235,245],
        ["EndTag","textarea",245,256],
        ["Character","\n",256,257]
      ]
    },
    {
      "description": "span tracking with naively_switch_states=true",
      "input": "<!DOCTYPE html>\n<h1>Hello</h1>\n<p attr=\"value\"></p>\n<p>content</p>\n<!-- A comment -->\n<h2>Subtitle</h2>\n<br/>\n<script>console.log('hello')</script>\n<script>nested('<div></div>')</script>\n<style>.class { color: red; }</style>\n<textarea>user input</textarea>\n",
      "naively_switch_states": true,
      "expected_tokens": [
        ["DOCTYPE","html",null,null,true,0,15],
        ["Character","\n",15,16],
        ["StartTag","h1",{},false,16,20],
        ["Character","Hello",20,25],
        ["EndTag","h1",25,30],
        ["Character","\n",30,31],
        ["StartTag","p",{"attr":["value",34,46]},false,31,47],
        ["EndTag","p",47,51],
        ["Character","\n",51,52],
        ["StartTag","p",{},false,52,55],
        ["Character","content",55,62],
        ["EndTag","p",62,66],
        ["Character","\n",66,67],
        ["Comment"," A comment ",67,85],
        ["Character","\n",85,86],
        ["StartTag","h2",{},false,86,90],
        ["Character","Subtitle",90,98],
        ["EndTag","h2",98,103],
        ["Character","\n",103,104],
        ["StartTag","br",{},true,104,109],
        ["Character","\n",109,110],
        ["StartTag","script",{},false,110,118],
        ["Character","console.log('hello')",118,138],
        ["EndTag","script",138,147],
        ["Character","\n",147,148],
        ["StartTag","script",{},false,148,156],
        ["Character","nested('<div></div>')",156,177],
        ["EndTag","script",177,186],
        ["Character","\n",186,187],
        ["StartTag","style",{},false,187,194],
        ["Character",".class { color: red; }",194,216],
        ["EndTag","style",216,224],
        ["Character","\n",224,225],
        ["StartTag","textarea",{},false,225,235],
        ["Character","user input",235,245],
        ["EndTag","textarea",245,256],
        ["Character","\n",256,257]
      ]
    },
    {
      "description": "bug 127: character reference span",
      "input": "&<!",
      "naively_switch_states": false,
      "expected_tokens": [
        ["Error","IncorrectlyOpenedComment",3,3],
        ["Character","&",0,1],
        ["Comment","",1,3]
      ]
    },
    {
      "description": "bug 127: character reference span, version 2",
      "input": "asdasd&<!",
      "naively_switch_states": false,
      "expected_tokens": [
        ["Error","IncorrectlyOpenedComment",9,9],
        ["Character","asdasd&",0,7],
        ["Comment","",7,9]
      ]
    },
    {
      "description": "bug 127: token order",
      "input": "0<h 0 0 0",
      "naively_switch_states": false,
      "expected_tokens": [
        ["Character","0",0,1],
        ["Error","DuplicateAttribute",6,7],
        ["Error","EofInTag",9,9]
      ]
    },
    {
      "description": "fuzz: <<z>",
      "input": "<<z>",
      "naively_switch_states": false,
      "expected_tokens": [
        ["Error","InvalidFirstCharacterOfTagName",2,2],
        ["Character","<",0,1],
        ["StartTag","z",{},false,1,4]
      ]
    },
    {
      "description": "fuzz: CRLF BOGUS COMMENT",
      "input": "\r\n<!",
      "naively_switch_states": false,
      "expected_tokens": [
        ["Error","IncorrectlyOpenedComment",4,4],
        ["Character","\n",0,2],
        ["Comment","",2,4]
      ]
    },
    {
      "description": "fuzz: bad attribute name",
      "input": "<a\f\u0000>",
      "naively_switch_states": false,
      "expected_tokens": [
        ["Error","UnexpectedNullCharacter",4,4],
        ["StartTag","a",{"\ufffd":["",3,4]},false,0,5]
      ]
    },
    {
      "description": "fuzz: span overlap from named characters",
      "input": "&xi;</0",
      "naively_switch_states": false,
      "expected_tokens": [
        ["Error","InvalidFirstCharacterOfTagName",7,7],
        ["Character","Î¾",0,4],
        ["Comment","0",4,7]
      ]
    },
    {
      "description": "fuzz: span overlap from numeric character refs",
      "input": "&#<?",
      "naively_switch_states": false,
      "expected_tokens": [
        ["Error","AbsenceOfDigitsInNumericCharacterReference",3,3],
        ["Error","UnexpectedQuestionMarkInsteadOfTagName",4,4],
        ["Character","&#",0,2],
        ["Comment","?",2,4]
      ]
    },
    {
      "description": "fuzz: span overlap from hex character refs",
      "input": "&#x<?",
      "naively_switch_states": false,
      "expected_tokens": [
        ["Error","AbsenceOfDigitsInNumericCharacterReference",4,4],
        ["Error","UnexpectedQuestionMarkInsteadOfTagName",5,5],
        ["Character","&#x",0,3],
        ["Comment","?",3,5]
      ]
    },
    {
      "description": "fuzz: CRLF, then bogus comment",
      "input": "<i\r\n><!",
      "naively_switch_states": false,
      "expected_tokens": [
        ["StartTag","i",{},false,0,5],
        ["Error","IncorrectlyOpenedComment",7,7],
        ["Comment","",5,7]
      ]
    },
    {
      "description": "fuzz: span overlap in script tag",
      "input": "<script><</script>",
      "naively_switch_states": true,
      "expected_tokens": [
        ["StartTag","script",{},false,0,8],
        ["Character","<",8,9],
        ["EndTag","script",9,18]
      ]
    },
    {
      "description": "fuzz: span overlap in script tag, part 2",
      "input": "<script></</script>",
      "naively_switch_states": true,
      "expected_tokens": [
        ["StartTag","script",{},false,0,8],
        ["Character","</",8,10],
        ["EndTag","script",10,19]
      ]
    },
    {
      "description": "fuzz: span overlap in script tag, part 3",
      "input": "<script></i</script>",
      "naively_switch_states": true,
      "expected_tokens": [
        ["StartTag","script",{},false,0,8],
        ["Character","</i",8,11],
        ["EndTag","script",11,20]
      ]
    },
    {
      "description": "fuzz: span overlap in script tag, part 4",
      "input": "<script><!--</script>",
      "naively_switch_states": true,
      "expected_tokens": [
        ["StartTag","script",{},false,0,8],
        ["Character","<!--",8,12],
        ["EndTag","script",12,21]
      ]
    },
    {
      "description": "fuzz: span overlap in script tag, part 5",
      "input": "<script><!--0</script>",
      "naively_switch_states": true,
      "expected_tokens": [
        ["StartTag","script",{},false,0,8],
        ["Character","<!--0",8,13],
        ["EndTag","script",13,22]
      ]
    },
    {
      "description": "fuzz: span overlap in script tag, part 6",
      "input": "<script><!--0-</script>",
      "naively_switch_states": true,
      "expected_tokens": [
        ["StartTag","script",{},false,0,8],
        ["Character","<!--0-",8,14],
        ["EndTag","script",14,23]
      ]
    }
  ]
}
